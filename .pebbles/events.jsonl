{"type":"create","timestamp":"2026-02-18T23:41:42.503592Z","issue_id":"open-lcm-8a9","payload":{"description":"","priority":"1","title":"Rewrite OpenClaw core imports to dependency injection","type":"task"}}
{"type":"comment","timestamp":"2026-02-18T23:41:50.059857Z","issue_id":"open-lcm-8a9","payload":{"body":"## Task\n\nAll source files in src/ were copied from openclaw src/plugins/lcm/ and src/agents/tools/lcm-*.ts. They still have imports pointing to OpenClaw internals.\n\nRead specs/extraction-plan.md for the full import rewrite map.\nRead src/types.ts for the LcmDependencies interface.\n\n### Phase 1: Simple files — already clean\n- src/db/config.ts ✅\n- src/store/fts5-sanitize.ts ✅\n- src/store/index.ts ✅\n\n### Phase 2: Connection + migration\n- src/db/connection.ts — replace requireNodeSqlite with direct better-sqlite3 import\n- src/db/migration.ts — fix internal imports\n\n### Phase 3: Core engine files — thread LcmDependencies\nEach file that imports from OpenClaw core needs to accept LcmDependencies as a parameter and use injected deps instead of direct imports. Key files: summarize.ts, assembler.ts, compaction.ts, engine.ts, expansion*.ts, integrity.ts, large-files.ts, retrieval.ts\n\n### Phase 4: Tool files\n- Create src/tools/common.ts with local jsonResult, readStringParam, AnyAgentTool\n- Refactor each tool to factory function: createLcmGrepTool(deps) =\u003e AnyAgentTool\n- Replace context-engine imports with openclaw/plugin-sdk\n\n### Phase 5: Wire up index.ts\n- Construct LcmDependencies from OpenClawPluginApi\n- Register context engine and all tools\n\n### Phase 6: Fix test imports\n- Update test import paths, mock LcmDependencies\n\n### Constraints\n- Keep @mariozechner/pi-agent-core as peer dep for message types\n- ContextEngine interface from openclaw/plugin-sdk\n- Pure import/DI refactor — no business logic changes\n- Verify with npx tsc --noEmit"}}
{"type":"status_update","timestamp":"2026-02-18T23:44:08.406373Z","issue_id":"open-lcm-8a9","payload":{"status":"in_progress"}}
{"type":"close","timestamp":"2026-02-18T23:57:42.905438Z","issue_id":"open-lcm-8a9","payload":{}}
{"type":"create","timestamp":"2026-02-19T15:24:24.112281Z","issue_id":"open-lcm-6fc","payload":{"description":"Implement the full spec at specs/summary-presentation-and-depth-aware-prompts.md. Five phases: (1) schema migration for earliest_at, latest_at, descendant_count columns with backfill, (2) XML summary presentation format in assembler.ts replacing informal headers, (3) depth-dispatched summarization prompts (leaf, d1, d2, d3+) replacing single Pi-style template, (4) timestamp injection in compaction leafPass and condensedPass, (5) SummaryStore type/read/write updates.","priority":"1","title":"Depth-aware prompts, XML presentation, and schema additions","type":"task"}}
{"type":"status_update","timestamp":"2026-02-19T15:24:53.443082Z","issue_id":"open-lcm-6fc","payload":{"status":"in_progress"}}
{"type":"close","timestamp":"2026-02-19T15:32:41.583842Z","issue_id":"open-lcm-6fc","payload":{}}
{"type":"create","timestamp":"2026-02-20T14:10:05.458946Z","issue_id":"open-lcm-a52","payload":{"description":"","priority":"1","title":"Fix all 24 broken vitest tests","type":"task"}}
{"type":"comment","timestamp":"2026-02-20T14:10:12.211593Z","issue_id":"open-lcm-a52","payload":{"body":"All 24 test files fail on module resolution. Two categories:\n\n1. **Relative path mismatch**: Tests in test/ import from ./foo.js (e.g. ./assembler.js, ./engine.js, ./db/config.js) as if co-located with src/. Need vitest.config.ts with path aliases or rewrite imports to ../src/foo.js.\n\n2. **Stale monorepo imports**: Some tests still reference OpenClaw core internals:\n   - summarize.test.ts imports from ../../agents/model-auth.js, ../../agents/pi-embedded-runner/model.js, ../../providers/github-copilot-token.js\n   - lcm-tools.test.ts imports from ../../plugins/lcm/expansion-auth.js, ../../context-engine/init.js, ../../context-engine/registry.js\n   These need to be rewritten to use the plugin's own exports or properly mocked.\n\n**Fix plan:**\n1. Create vitest.config.ts with resolve.alias mapping or just fix all import paths\n2. Fix category 1: rewrite ./foo.js to ../src/foo.js in all test files\n3. Fix category 2: rewrite monorepo imports to use local plugin paths + proper mocks\n4. Ensure tsconfig includes test files (currently excludes **/*.test.ts)\n5. Run npx vitest run — all 24 suites should pass\n6. Do NOT change any business logic — import/config fixes only"}}
{"type":"status_update","timestamp":"2026-02-20T14:10:43.891971Z","issue_id":"open-lcm-a52","payload":{"status":"in_progress"}}
{"type":"close","timestamp":"2026-02-20T14:20:29.231118Z","issue_id":"open-lcm-a52","payload":{}}
{"type":"create","timestamp":"2026-02-20T15:40:05.959578Z","issue_id":"open-lcm-2b7","payload":{"description":"Review all uses of the name 'openclaw-lcm', 'open-lcm', '@martian-engineering/openclaw-lcm' across the entire repo and produce a comprehensive rename specification for changing the project name to 'lossless-claw' (npm: '@martian-engineering/lossless-claw' or similar).\n\nAudit should cover:\n- package.json (name, description, repository, homepage)\n- README.md (all references)\n- docs/*.md (all references)\n- Source code: any string literals, comments, log messages referencing the old name\n- Go module path in tui/go.mod\n- .goreleaser.yml (binary names, project name)\n- tui/Makefile\n- GitHub repo name implications (remote URLs, links in docs)\n- Import paths if package name changes\n- Any references in test files\n\nOutput: a checklist of every file and line that needs to change, with proposed new values. Do NOT make the changes — just document them.","priority":"2","title":"Audit and spec rename from openclaw-lcm to lossless-claw","type":"task"}}
{"type":"status_update","timestamp":"2026-02-20T15:40:38.518306Z","issue_id":"open-lcm-2b7","payload":{"status":"in_progress"}}
{"type":"close","timestamp":"2026-02-20T15:42:48.356723Z","issue_id":"open-lcm-2b7","payload":{}}
{"type":"create","timestamp":"2026-02-20T18:27:44.70641Z","issue_id":"lossless-claw-1c2","payload":{"description":"In the sessions list screen, display an estimate of the total tokens contained in each session JSONL file. Use the existing len/4 estimator. Helps users gauge raw content size before drilling in.","priority":"2","title":"TUI sessions view: show estimated total tokens per session file","type":"enhancement"}}
{"type":"status_update","timestamp":"2026-02-20T18:29:58.353543Z","issue_id":"lossless-claw-1c2","payload":{"status":"in_progress"}}
{"type":"close","timestamp":"2026-02-20T18:32:05.700988Z","issue_id":"lossless-claw-1c2","payload":{}}
