{"type":"create","timestamp":"2026-02-18T23:41:42.503592Z","issue_id":"open-lcm-8a9","payload":{"description":"","priority":"1","title":"Rewrite OpenClaw core imports to dependency injection","type":"task"}}
{"type":"comment","timestamp":"2026-02-18T23:41:50.059857Z","issue_id":"open-lcm-8a9","payload":{"body":"## Task\n\nAll source files in src/ were copied from openclaw src/plugins/lcm/ and src/agents/tools/lcm-*.ts. They still have imports pointing to OpenClaw internals.\n\nRead specs/extraction-plan.md for the full import rewrite map.\nRead src/types.ts for the LcmDependencies interface.\n\n### Phase 1: Simple files — already clean\n- src/db/config.ts ✅\n- src/store/fts5-sanitize.ts ✅\n- src/store/index.ts ✅\n\n### Phase 2: Connection + migration\n- src/db/connection.ts — replace requireNodeSqlite with direct better-sqlite3 import\n- src/db/migration.ts — fix internal imports\n\n### Phase 3: Core engine files — thread LcmDependencies\nEach file that imports from OpenClaw core needs to accept LcmDependencies as a parameter and use injected deps instead of direct imports. Key files: summarize.ts, assembler.ts, compaction.ts, engine.ts, expansion*.ts, integrity.ts, large-files.ts, retrieval.ts\n\n### Phase 4: Tool files\n- Create src/tools/common.ts with local jsonResult, readStringParam, AnyAgentTool\n- Refactor each tool to factory function: createLcmGrepTool(deps) =\u003e AnyAgentTool\n- Replace context-engine imports with openclaw/plugin-sdk\n\n### Phase 5: Wire up index.ts\n- Construct LcmDependencies from OpenClawPluginApi\n- Register context engine and all tools\n\n### Phase 6: Fix test imports\n- Update test import paths, mock LcmDependencies\n\n### Constraints\n- Keep @mariozechner/pi-agent-core as peer dep for message types\n- ContextEngine interface from openclaw/plugin-sdk\n- Pure import/DI refactor — no business logic changes\n- Verify with npx tsc --noEmit"}}
{"type":"status_update","timestamp":"2026-02-18T23:44:08.406373Z","issue_id":"open-lcm-8a9","payload":{"status":"in_progress"}}
{"type":"close","timestamp":"2026-02-18T23:57:42.905438Z","issue_id":"open-lcm-8a9","payload":{}}
{"type":"create","timestamp":"2026-02-19T15:24:24.112281Z","issue_id":"open-lcm-6fc","payload":{"description":"Implement the full spec at specs/summary-presentation-and-depth-aware-prompts.md. Five phases: (1) schema migration for earliest_at, latest_at, descendant_count columns with backfill, (2) XML summary presentation format in assembler.ts replacing informal headers, (3) depth-dispatched summarization prompts (leaf, d1, d2, d3+) replacing single Pi-style template, (4) timestamp injection in compaction leafPass and condensedPass, (5) SummaryStore type/read/write updates.","priority":"1","title":"Depth-aware prompts, XML presentation, and schema additions","type":"task"}}
{"type":"status_update","timestamp":"2026-02-19T15:24:53.443082Z","issue_id":"open-lcm-6fc","payload":{"status":"in_progress"}}
{"type":"close","timestamp":"2026-02-19T15:32:41.583842Z","issue_id":"open-lcm-6fc","payload":{}}
